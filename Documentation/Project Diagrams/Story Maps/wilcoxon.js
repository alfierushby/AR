var k = 1*nn;var w = 1*0;var yell = 1*0;var diff = new Array();var rdiff = new Array();var a = 1*0; <!--count fills-->var lz = 1*0;var min = 1*10e6;var b = 1*0;var xjz = " ";function rnd6(x){return Math.round(x*1000000)/1000000}<!--begin f. zip-->function zip(){for (var i=0; i<k; i++)<!--begin ziploop1-->{if(document.y.elements[i].value !="") <!--begin if1-->{if(1*document.y.elements[i].value <= 1*min) <!--begin if2-->{min = 1*document.y.elements[i].value;}<!--end if2-->}<!--end if1-->}<!--end ziploop1-->}<!--end f. zip--><!--begin f. sort-->function sort(){min =1*min;<!--begin sortloop_1-->for (var p=0; p<k; p++){	if(document.y.elements[p].value==min)<!--begin sortif1-->	{	document.z.elements[a].value = document.y.elements[p].value;	document.y.elements[p].value = "";	a = 1*a+1;	}<!--end sortif1-->} <!--end sortloop_1-->min = 1*10e6;}<!--end f. sort--><!--begin f. spin-->function spin(){var xxx = 1*0;for (var q=0; q<k; q++)<!--begin spinloop_datatest-->{if(document.x.elements[q].value==""){xxx = 1*1;}}<!--end spinloop_datatest-->if(1*xxx>0){alert("Data error.  Please check your data entries.");}for (var q=0; q<k; q++)<!--begin spinloop1-->{if(1*xxx>0) {break};document.y.elements[q].value = document.x.elements[q].value;}<!--end spinloop1-->for (var j=0; j<k; j++)<!--begin spinloop2-->{if(1*xxx>0) {break};zip();sort();} <!--end spinloop2-->document.y.elements[0].value = 1;for (var q=1; q<k; q++)<!--begin spinloop3-->{if(1*xxx>0) {break};	if(1*document.z.elements[q].value > 1*document.z.elements[q-1].value)	{	document.y.elements[q].value = 1*document.y.elements[q-1].value+1;	} else {	document.y.elements[q].value = document.y.elements[q-1].value;	}<!--end ifelse-->}<!--end spinloop3-->for (var q=0; q<k; q++)<!--begin spinloop3a-->{document.rank.elements[q].value = document.y.elements[q].value;}<!--end spinloop3a-->for (var jj=0; jj<k; jj++)<!--begin spinloopjj-->{if(1*xxx>0) {break};a = 1*0;b = 1*0;lz = 1*0;	for (var q=0; q<k; q++)<!--begin spinloopjj1-->	{		if((1*document.y.elements[q].value)==(1*jj+1))		{		a = 1*a+1;		b = (1*b)+(1*document.count.elements[q].value);				}	}<!--end spinloopjj1-->		if(a>0)		{		lz = b/a;		}	for (var s=0; s<k; s++)<!--begin spinloopjj2-->	{		if((1*document.y.elements[s].value)==(1*jj+1))		{		document.y.elements[s].value = lz;		}<!--end if-->	}<!--end spinloopjj2-->}<!--end spinloopjj-->if((1*document.z.elements[0].value)<(1*document.z.elements[1].value)){document.y.elements[0].value = document.count.elements[0].value;}<!--end if-->if((1*document.z.elements[k-1].value)>(1*document.z.elements[k-2].value)){document.y.elements[k-1].value =document.count.elements[k-1].value;}<!--end if-->for (var j=1; j<(k-1); j++)<!--begin spinloop_rectify-->{if(1*xxx>0) {break};if(((1*document.z.elements[j].value)<(1*document.z.elements[1*j+1].value))&&((1*document.z.elements[j].value)>(1*document.z.elements[1*j-1].value))){document.y.elements[j].value = document.count.elements[j].value;}<!--end if-->} <!--endspinloop_ rectify-->for (var jj=0; jj<k; jj++)<!--begin spinloopjjx-->{if(1*xxx>0) {break};a = 1*0;b = 1*0;lz = 1*0;	for (var q=0; q<k; q++)<!--begin spinloopjj1-->	{		if((1*document.rank.elements[q].value)==(1*jj+1))		{		a = 1*a+1;		b = (1*b)+(1*document.count.elements[q].value);				}	}<!--end spinloopjj1-->		if(a>0)		{		lz = b/a;		}	for (var s=0; s<k; s++)<!--begin spinloopjj2-->	{		if((1*document.rank.elements[s].value)==(1*jj+1))		{		document.y.elements[s].value = lz;		}<!--end if-->	}<!--end spinloopjj2-->}<!--end spinloopjjx-->for (var jj=0; jj<k; jj++)<!--begin final spinloop-->{if(1*xxx>0) {break};for (var i=0; i<k; i++)<!--begin final subloop-->{if(document.x.elements[i].value==document.z.elements[jj].value){document.rank.elements[i].value = document.y.elements[jj].value;}<!--end if-->}<!--end final subloop-->}<!--end final spinloop-->var xy_vals = "";for (var i=0; i<k-1; i++) {xy_vals = xy_vals+document.x.elements[i].value+"\t"+document.rank.elements[i].value+"\r";}xy_vals = xy_vals+document.x.elements[k-1].value+"\t"+document.rank.elements[k-1].value;}<!--end f. spin-->function calc() {min = 1*10e6;w = 1*0;yell = 1*0;for (var i=0; i<k; i++) {	if (document.x_vals.elements[i].value=="") {yell++;}	}for (var i=0; i<k; i++) {	if (document.y_vals.elements[i].value=="") {yell++;}	}if (yell>0) {alert("Caution: Please check your data to make sure they are entered correctly.")}for (var i=0; i<k; i++){diff[i]=document.x_vals.elements[i].value-document.y_vals.elements[i].value}for (var i=0; i<k; i++){document.x.elements[i].value=Math.abs(rnd6(diff[i]))}spin();for (var i=0; i<k; i++){rdiff[i] = document.rank.elements[i].value;}var clip = 1*0;for (var i=0; i<k; i++){if(diff[i]==0){rdiff[i] = 1*0;clip++;}<!--end.if-->}<!--end.for-->for (var i=0; i<k; i++){if(rdiff[i]!=0){rdiff[i]-=clip;}<!--end.if-->}<!--end.for-->var nclip = k-clip;for (var i=0; i<k; i++){if (diff[i]<0){rdiff[i] = rdiff[i]*(-1);}<!--end.if-->}<!--end.for-->for (var i=0; i<k; i++){w+=rdiff[i];}<!--end.for-->for (var i=0; i<k; i++){if(rdiff[i]>0){document.xy_vals.elements[i].value = "+"+rdiff[i];} else {if(rdiff[i]==0){document.xy_vals.elements[i].value = "---";} else {document.xy_vals.elements[i].value = rdiff[i];}<!--end.if/else.in-->}<!--end.if/else.out-->}<!--end.for-->document.wn.elements[0].value = w;document.wn.elements[1].value = nclip;if(w>0) {w-=.5;}if(w<0) {w+=.5;}var sig = ((nclip*(nclip+1))*((2*nclip)+1))/6;sig = Math.sqrt(sig);sig = w/sig;sig = Math.round(sig*100)/100;var z = Math.abs(sig);document.wn.elements[2].value = "---";document.wn.elements[3].value = "---";document.wn.elements[4].value = "---";if(nclip>9) {document.wn.elements[2].value = sig;var p2 = (((((.000005383*z+.0000488906)*z+.0000380036)*z+.0032776263)*z+.0211410061)*z+.049867347)*z+1;p2 = Math.pow(p2, -16);var p1 = p2/2;p2 = Math.round(p2*10000)/10000;p1 = Math.round(p1*10000)/10000;if(p2<.0001||p2>1){p2="<.0001"}if(p1<.0001||p1>1){p1="<.0001"}document.wn.elements[3].value = p1;document.wn.elements[4].value = p2;}<!--end.if-->var xy_vals = "";for (var i=0; i<k-1; i++) {xy_vals = xy_vals+document.x_vals.elements[i].value+"\t"+document.y_vals.elements[i].value+"\t"+document.xy_vals.elements[i].value+"\r";}xy_vals = xy_vals+document.x_vals.elements[k-1].value+"\t"+document.y_vals.elements[k-1].value+"\t"+document.xy_vals.elements[i].value;document.jjx.elements[0].value = xy_vals;}<!--end.f.calc-->function wipe() {var k = nn;for (var i=0; i<k; i++) {document.x_vals.elements[i].value = "";document.y_vals.elements[i].value = "";document.xy_vals.elements[i].value = "-----";}<!--end.for-->for (var i=0; i<5; i++) {document.wn.elements[i].value = "";}<!--end.for-->document.jjx.elements[0].value = "";}<!--end.f.wipe-->